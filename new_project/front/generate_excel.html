<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦ç”Ÿä¿¡æ¯Excelç”Ÿæˆå™¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }

        .button-group {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-bottom: 30px;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .info {
            background: #f8f9ff;
            border: 1px solid #e1e5f2;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .info h3 {
            margin-top: 0;
            color: #667eea;
        }

        .data-preview {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e1e5f2;
            border-radius: 8px;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        th,
        td {
            padding: 8px 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #667eea;
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }

        tr:hover {
            background: #f8f9ff;
        }

        .error-row {
            background: #fee !important;
        }

        .success-row {
            background: #efe !important;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ“Š å­¦ç”Ÿä¿¡æ¯Excelç”Ÿæˆå™¨</h1>

        <div class="info">
            <h3>ğŸ¯ åŠŸèƒ½è¯´æ˜</h3>
            <p>æ­¤å·¥å…·å¯ä»¥ç”Ÿæˆç”¨äºæ¼”ç¤ºå‰ç«¯æ‰¹é‡å¯¼å…¥åŠŸèƒ½çš„Excelæ–‡ä»¶ï¼š</p>
            <ul>
                <li><strong>æ ‡å‡†æ¨¡æ¿</strong>ï¼šåŒ…å«25åå­¦ç”Ÿçš„å®Œæ•´ä¿¡æ¯ï¼Œæ‰€æœ‰æ•°æ®ç¬¦åˆè§„èŒƒ</li>
                <li><strong>é”™è¯¯ç¤ºä¾‹</strong>ï¼šåŒ…å«10æ¡è®°å½•ï¼Œå…¶ä¸­6æ¡æœ‰é”™è¯¯ï¼Œç”¨äºæµ‹è¯•æ•°æ®éªŒè¯åŠŸèƒ½</li>
            </ul>
        </div>

        <div class="button-group">
            <button onclick="downloadStandardTemplate()">ğŸ“ ä¸‹è½½æ ‡å‡†æ¨¡æ¿</button>
            <button onclick="downloadErrorTemplate()">âš ï¸ ä¸‹è½½é”™è¯¯ç¤ºä¾‹</button>
            <button onclick="showPreview('standard')">ğŸ‘€ é¢„è§ˆæ ‡å‡†æ•°æ®</button>
            <button onclick="showPreview('error')">ğŸ” é¢„è§ˆé”™è¯¯æ•°æ®</button>
        </div>

        <div id="dataPreview" class="data-preview" style="display: none;">
            <table id="previewTable">
                <thead>
                    <tr>
                        <th>å­¦å·</th>
                        <th>å§“å</th>
                        <th>æ€§åˆ«</th>
                        <th>å…¥å­¦æˆç»©</th>
                        <th>å­¦ä¹ é£æ ¼</th>
                        <th>ç‰¹æ®Šéœ€æ±‚</th>
                        <th>å¤‡æ³¨</th>
                        <th>çŠ¶æ€</th>
                    </tr>
                </thead>
                <tbody id="previewBody">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // æ ‡å‡†å­¦ç”Ÿæ•°æ®
        const standardData = [
            ["å­¦å·", "å§“å", "æ€§åˆ«", "å…¥å­¦æˆç»©", "å­¦ä¹ é£æ ¼", "ç‰¹æ®Šéœ€æ±‚", "å¤‡æ³¨"],
            ["2024001", "å¼ ä¸‰", "ç”·", 85, "å›¾åƒå‹", "æ— ", "æ•°å­¦åŸºç¡€è¾ƒå¥½"],
            ["2024002", "æå°çº¢", "å¥³", 78, "è§£æå‹", "æ³¨æ„åŠ›ä¸é›†ä¸­", "éœ€è¦é¢å¤–å…³æ³¨"],
            ["2024003", "ç‹æ˜", "ç”·", 92, "åº”ç”¨å‹", "æ— ", "ç†è§£èƒ½åŠ›å¼º"],
            ["2024004", "é™ˆç¾ä¸½", "å¥³", 67, "å›¾åƒå‹", "å­¦ä¹ å›°éš¾", "éœ€è¦ä¸ªåˆ«è¾…å¯¼"],
            ["2024005", "åˆ˜å¼º", "ç”·", 88, "è§£æå‹", "æ— ", "é€»è¾‘æ€ç»´èƒ½åŠ›å¼º"],
            ["2024006", "èµµé›ª", "å¥³", 72, "å›¾åƒå‹", "è§†åŠ›é—®é¢˜", "éœ€è¦åå‰æ’"],
            ["2024007", "å­™æµ©", "ç”·", 95, "åº”ç”¨å‹", "æ— ", "æ•°å­¦ç«èµ›è·å¥–"],
            ["2024008", "å‘¨å©·å©·", "å¥³", 81, "è§£æå‹", "æƒ…ç»ªè°ƒèŠ‚å›°éš¾", "éœ€è¦å¿ƒç†å…³æ€€"],
            ["2024009", "å´æ°", "ç”·", 76, "å›¾åƒå‹", "æ— ", "å–œæ¬¢é€šè¿‡å›¾è¡¨å­¦ä¹ "],
            ["2024010", "éƒ‘èŠ³", "å¥³", 89, "åº”ç”¨å‹", "æ— ", "å–„äºè§£å†³å®é™…é—®é¢˜"],
            ["2024011", "é©¬å°å†›", "ç”·", 64, "å›¾åƒå‹", "è®¡ç®—å›°éš¾", "åŸºç¡€éœ€è¦åŠ å¼º"],
            ["2024012", "æ—é™", "å¥³", 83, "è§£æå‹", "æ— ", "å–„äºå½’çº³æ€»ç»“"],
            ["2024013", "é»„å‹‡", "ç”·", 77, "åº”ç”¨å‹", "å¬åŠ›é—®é¢˜", "éœ€è¦ç‰¹æ®Šåº§ä½å®‰æ’"],
            ["2024014", "è®¸æ¢…", "å¥³", 90, "å›¾åƒå‹", "æ— ", "ç©ºé—´æƒ³è±¡åŠ›å¼º"],
            ["2024015", "æ›¹äº®", "ç”·", 86, "è§£æå‹", "æ— ", "é€»è¾‘æ¨ç†èƒ½åŠ›å‡ºè‰²"],
            ["2024016", "ä¸å°å", "å¥³", 70, "å›¾åƒå‹", "å®¶åº­å›°éš¾", "éœ€è¦å…³æ³¨å¿ƒç†çŠ¶æ€"],
            ["2024017", "èŒƒä¼Ÿ", "ç”·", 79, "åº”ç”¨å‹", "æ— ", "åŠ¨æ‰‹èƒ½åŠ›å¼º"],
            ["2024018", "é«˜ç²", "å¥³", 84, "è§£æå‹", "æ— ", "å–„äºåˆ†æå’Œæ€»ç»“"],
            ["2024019", "éŸ©ç£Š", "ç”·", 73, "å›¾åƒå‹", "æ³¨æ„åŠ›ç¼ºé™·", "éœ€è¦å¤šæ¬¡æé†’"],
            ["2024020", "æ±Ÿé›¨", "å¥³", 87, "åº”ç”¨å‹", "æ— ", "å–„äºè”ç³»å®é™…ç”Ÿæ´»"],
            ["2024021", "å­”æ˜", "ç”·", 91, "è§£æå‹", "æ— ", "æ•°å­¦æ€ç»´æ¸…æ™°"],
            ["2024022", "æ¢å°ç‡•", "å¥³", 75, "å›¾åƒå‹", "æ— ", "è§†è§‰å­¦ä¹ è€…"],
            ["2024023", "å®å¼º", "ç”·", 82, "åº”ç”¨å‹", "è½»å¾®è‡ªé—­", "éœ€è¦è€å¿ƒå¼•å¯¼"],
            ["2024024", "æ¬§é˜³é›ª", "å¥³", 88, "è§£æå‹", "æ— ", "é€»è¾‘æ€ç»´å¼º"],
            ["2024025", "æ½˜æ°", "ç”·", 69, "å›¾åƒå‹", "å­¦ä¹ éšœç¢", "éœ€è¦ç‰¹æ®Šæ•™å­¦æ–¹æ³•"]
        ];

        // åŒ…å«é”™è¯¯çš„æ•°æ®
        const errorData = [
            ["å­¦å·", "å§“å", "æ€§åˆ«", "å…¥å­¦æˆç»©", "å­¦ä¹ é£æ ¼", "ç‰¹æ®Šéœ€æ±‚", "å¤‡æ³¨"],
            ["2024026", "æµ‹è¯•å­¦ç”Ÿ1", "ç”·", 85, "å›¾åƒå‹", "æ— ", "æ­£å¸¸æ•°æ®"],
            ["", "æé”™è¯¯", "å¥³", 78, "è§£æå‹", "æ— ", "å­¦å·ä¸ºç©º"],
            ["2024028", "ç‹", "ç”·", "abc", "å›¾åƒå‹", "æ— ", "æˆç»©ä¸æ˜¯æ•°å­—"],
            ["2024029", "é™ˆæµ‹è¯•", "å…¶ä»–", 88, "å›¾åƒå‹", "æ— ", "æ€§åˆ«é”™è¯¯"],
            ["2024030", "åˆ˜åŒå­¦", "å¥³", 120, "é”™è¯¯é£æ ¼", "æ— ", "æˆç»©è¶…å‡ºèŒƒå›´ä¸”å­¦ä¹ é£æ ¼é”™è¯¯"],
            ["2024031", "èµµæ­£å¸¸", "ç”·", 75, "åº”ç”¨å‹", "æ— ", "æ­£å¸¸æ•°æ®"],
            ["2024032", "å­™æµ‹è¯•", "å¥³", 45, "è§£æå‹", "æ— ", "æˆç»©è¿‡ä½"],
            ["", "å¼ æ— å·", "ç”·", 82, "å›¾åƒå‹", "æ— ", "å­¦å·ç¼ºå¤±"],
            ["2024034", "", "å¥³", 78, "è§£æå‹", "æ— ", "å§“åä¸ºç©º"],
            ["2024035", "æåˆæ ¼", "ç”·", 88, "å›¾åƒå‹", "æ— ", "æ­£å¸¸æ•°æ®"]
        ];

        function downloadStandardTemplate() {
            downloadExcel(standardData, 'å­¦ç”Ÿä¿¡æ¯æ ‡å‡†æ¨¡æ¿.xlsx');
        }

        function downloadErrorTemplate() {
            downloadExcel(errorData, 'å­¦ç”Ÿä¿¡æ¯é”™è¯¯ç¤ºä¾‹.xlsx');
        }

        function downloadExcel(data, filename) {
            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(data);

            // è®¾ç½®åˆ—å®½
            const colWidths = [
                { wch: 12 }, // å­¦å·
                { wch: 10 }, // å§“å
                { wch: 6 },  // æ€§åˆ«
                { wch: 10 }, // å…¥å­¦æˆç»©
                { wch: 10 }, // å­¦ä¹ é£æ ¼
                { wch: 15 }, // ç‰¹æ®Šéœ€æ±‚
                { wch: 20 }  // å¤‡æ³¨
            ];
            ws['!cols'] = colWidths;

            // è®¾ç½®è¡¨å¤´æ ·å¼
            const headerStyle = {
                font: { bold: true, color: { rgb: "FFFFFF" } },
                fill: { fgColor: { rgb: "667eea" } },
                alignment: { horizontal: "center" }
            };

            // åº”ç”¨è¡¨å¤´æ ·å¼
            const range = XLSX.utils.decode_range(ws['!ref']);
            for (let col = range.s.c; col <= range.e.c; col++) {
                const cellAddress = XLSX.utils.encode_cell({ r: 0, c: col });
                if (!ws[cellAddress]) continue;
                ws[cellAddress].s = headerStyle;
            }

            XLSX.utils.book_append_sheet(wb, ws, "å­¦ç”Ÿä¿¡æ¯");
            XLSX.writeFile(wb, filename);
        }

        function showPreview(type) {
            const data = type === 'standard' ? standardData : errorData;
            const preview = document.getElementById('dataPreview');
            const tbody = document.getElementById('previewBody');

            tbody.innerHTML = '';

            // è·³è¿‡è¡¨å¤´ï¼Œä»ç¬¬äºŒè¡Œå¼€å§‹
            for (let i = 1; i < data.length; i++) {
                const row = data[i];
                const tr = document.createElement('tr');

                // æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯
                const hasError = validateRow(row);
                if (!hasError && type === 'error') {
                    tr.className = 'error-row';
                } else if (hasError && type === 'standard') {
                    tr.className = 'success-row';
                }

                // æ·»åŠ æ•°æ®åˆ—
                row.forEach(cell => {
                    const td = document.createElement('td');
                    td.textContent = cell || '(ç©º)';
                    tr.appendChild(td);
                });

                // æ·»åŠ çŠ¶æ€åˆ—
                const statusTd = document.createElement('td');
                statusTd.textContent = hasError ? 'âœ… æœ‰æ•ˆ' : 'âŒ é”™è¯¯';
                statusTd.style.fontWeight = 'bold';
                statusTd.style.color = hasError ? '#67C23A' : '#F56C6C';
                tr.appendChild(statusTd);

                tbody.appendChild(tr);
            }

            preview.style.display = 'block';
        }

        function validateRow(row) {
            const [studentId, name, gender, score, learningStyle, specialNeeds, remark] = row;

            // æ£€æŸ¥å¿…å¡«å­—æ®µ
            if (!studentId || !name) return false;

            // æ£€æŸ¥æ€§åˆ«
            if (!['ç”·', 'å¥³'].includes(gender)) return false;

            // æ£€æŸ¥æˆç»©
            const scoreNum = parseInt(score);
            if (isNaN(scoreNum) || scoreNum < 0 || scoreNum > 100) return false;

            // æ£€æŸ¥å­¦ä¹ é£æ ¼
            if (!['å›¾åƒå‹', 'è§£æå‹', 'åº”ç”¨å‹'].includes(learningStyle)) return false;

            return true;
        }
    </script>
</body>

</html>